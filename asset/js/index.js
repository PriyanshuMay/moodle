const addressOfLenderRaw=document.getElementById("addressOfLender"),amountOfMortgageRaw=document.getElementById("amountOfMortgage"),amountOfMortgageWordsRaw=document.getElementById("amountOfMortgageWords"),borrowerLawFirmNameRaw=document.getElementById("borrowerLawFirmName"),borrowerLawyerNameRaw=document.getElementById("borrowerLawyerName"),closingDateRaw=document.getElementById("closingDate"),dateOfSigningRaw=document.getElementById("dateOfSigning"),fileNumberRaw=document.getElementById("fileNumber"),instrumentNumberToDischargedRaw=document.getElementById("instrumentNumberToDischarged"),interestRateRaw=document.getElementById("interestRate"),nameOfLenderRaw=document.getElementById("nameOfLender"),nameOfBorrowerRaw=document.getElementById("nameOfBorrower"),municipalityOfSigningRaw=document.getElementById("municipalityOfSigning"),maturityDateRaw=document.getElementById("maturityDate"),propertyAddressRaw=document.getElementById("propertyAddress"),priorityOfMortgageRaw=document.getElementById("priorityOfMortgage"),prepaymentProvisionsRaw=document.getElementById("prepaymentProvisions"),submitBtn=document.getElementById("submitBtn");if("serviceWorker"in navigator)try{navigator.serviceWorker.register("sw.js"),console.log("Service Worker Registered Successfully")}catch(e){console.log("Service Worker Registration Failed")}function openClose(e,t,r){var n=document.getElementById(e);message=n.getElementsByClassName("message")[0],title=n.getElementsByClassName("modalTitle")[0],message.innerHTML=r,title.innerHTML=t,"none"===n.style.display?n.style.display="block":n.style.display="none"}function loadFile(e,t){PizZipUtils.getBinaryContent(e,t)}function generate(e,t,r,n,o,a,i,s,l,d,c,m,u,g,f,y,p,w){return loadFile("asset/sample.docx",function(v,B){if(v)throw v;function h(e,t){return t instanceof Error?Object.getOwnPropertyNames(t).reduce(function(e,r){return e[r]=t[r],e},{}):t}function R(e){if(console.log(JSON.stringify({error:e},h)),e.properties&&e.properties.errors instanceof Array){const t=e.properties.errors.map(function(e){return e.properties.explanation}).join("\n");console.log("errorMessages",t)}throw e}var b,O=new PizZip(B);try{b=new window.docxtemplater(O)}catch(v){openClose("alertBox","Shame on Us","Some error ocuured while creating the document file."),R(v)}b.setData({address_of_lender:n,amount_of_mortgage:u,amount_of_mortgage_words:m,borrower_lawyer_name:c,borrower_law_firm_name:d,closing_date:s,date_of_signing:a,file_number:l,instrument_number_to_discharged:p,interest_rate:f,name_of_lender:r,name_of_borrower:e,municipality_of_signing:o,maturity_date:g,property_address:t,priority_of_mortgage:i,prepayment_provisions:y});try{b.render()}catch(v){openClose("alertBox","Shame on Us","Some error ocuured while rendering the document file."),R(v)}const _=e+r+"_"+w+".doc";var L=b.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});saveAs(L,_)}),!0}submitBtn.addEventListener("click",()=>{const e=addressOfLenderRaw.value,t=amountOfMortgageRaw.value,r=amountOfMortgageWordsRaw.value,n=borrowerLawFirmNameRaw.value,o=borrowerLawyerNameRaw.value,a=closingDateRaw.value,i=dateOfSigningRaw.value,s=fileNumberRaw.value,l=instrumentNumberToDischargedRaw.value,d=interestRateRaw.value,c=nameOfLenderRaw.value,m=nameOfBorrowerRaw.value,u=municipalityOfSigningRaw.value,g=maturityDateRaw.value,f=propertyAddressRaw.value,y=priorityOfMortgageRaw.value,p=prepaymentProvisionsRaw.value;createDocx=generate(m,f,c,e,u,i,y,a,s,n,o,r,t,g,d,p,l,1),createDocx?openClose("successBox","Documents generated successfully via html form","Liked the project? Star the repo on GitHub."):openClose("alertBox","Error occured while creating PDF","Incorrect data enteries were found. Please take a look at the sampe.xlxs and fill up the data accordingly")});const file=document.querySelector("#file");file.addEventListener("change",e=>{const[t]=e.target.files,{name:r,size:n}=t,o=`${r} - ${(n/1e3).toFixed(2)}KB`;document.querySelector(".file-name").textContent=o});var navMenuDiv=document.getElementById("nav-content"),navMenu=document.getElementById("nav-toggle");function check(e){var t=e&&e.target;checkParent(t,navMenuDiv)||(checkParent(t,navMenu)&&navMenuDiv.classList.contains("hidden")?navMenuDiv.classList.remove("hidden"):navMenuDiv.classList.add("hidden"))}function checkParent(e,t){for(;e.parentNode;){if(e==t)return!0;e=e.parentNode}return!1}document.onclick=check;const modal=document.querySelector(".main-modal"),closeButton=document.querySelectorAll(".modal-close"),modalClose=()=>{modal.classList.remove("fadeIn"),modal.classList.add("fadeOut"),setTimeout(()=>{modal.style.display="none"},500)},openModal=()=>{modal.classList.remove("fadeOut"),modal.classList.add("fadeIn"),modal.style.display="flex"};for(let e=0;e<closeButton.length;e++){closeButton[e].onclick=(e=>modalClose()),modal.style.display="none",window.onclick=function(e){e.target==modal&&modalClose()}}window.addEventListener("load",function(){document.getElementById("upload").addEventListener("click",function(){var e=document.getElementById("file");if(/.+\.(xlsx|xls)$/i.test(e.value.toLowerCase()))if("undefined"!=typeof FileReader){var t=new FileReader;t.readAsBinaryString?(t.onload=function(e){r(e.target.result)},t.readAsBinaryString(e.files[0])):(t.onload=function(e){for(var t="",n=new Uint8Array(e.target.result),o=0;o<n.byteLength;o++)t+=String.fromCharCode(n[o]);r(t)},t.readAsArrayBuffer(e.files[0]))}else openClose("alertBox","Are you using IE ???","Current version of your browser isn;t supported.<br>Please update/change your browser");else openClose("alertBox","Invalid file selected","Please upload a valid .xlsx/.xls file.<br>Try renaming your file without any special characters");function r(e){for(var t=XLSX.read(e,{type:"binary"}),r=t.SheetNames[0],n=XLSX.utils.sheet_to_row_object_array(t.Sheets[r]),o=0;o<n.length;o++)createDocx=generate(n[o].nameOfBorrower,n[o].propertyAddress,n[o].nameOfLender,n[o].addressOfLender,n[o].municipalityOfSigning,n[o].dateOfSigning,n[o].priorityOfMortgage,n[o].closingDate,n[o].fileNumber,n[o].borrowerLawFirmName,n[o].borrowerLawyerName,n[o].amountOfMortgageWords,n[o].amountOfMortgage,n[o].maturityDate,n[o].interestRate,n[o].prepaymentProvisions,n[o].instrumentNumberToDischarged,o);createDocx?openClose("successBox","Documents generated successfully from .xlsx","Liked the project? Star the repo on GitHub."):openClose("alertBox","Error occured while creating PDF","Incorrect data enteries were found. Please take a look at the sampe.xlxs and fill up the data accordingly")}})});